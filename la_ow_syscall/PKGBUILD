pkgname=la_ow_syscall-dkms
pkgver=r23.1b837fd
pkgrel=1
pkgdesc="loongarch old-world syscall module sources"
arch=(any)
url="https://github.com/AOSC-Dev/la_ow_syscall"
license=(GPL2)
makedepends=(git)
depends=(dkms)
source=("git+https://github.com/AOSC-Dev/la_ow_syscall.git#branch=master")
sha256sums=('SKIP')

pkgver() {
  cd la_ow_syscall
  printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}

build() {
  cd la_ow_syscall
  make dkms.conf
}

package() {
  cd la_ow_syscall
  install -Dm644 *.c *.h dkms.conf VERSION Makefile -t "${pkgdir}"/usr/src/${pkgbase}-${pkgver}/
}
